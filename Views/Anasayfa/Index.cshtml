@{
    ViewData["Title"] = "Ana Sayfa";
}

<!-- Slider Başlangıç -->
<div id="mainCarousel" class="carousel slide mx-auto rounded-slider mt-5" data-bs-ride="carousel" style="max-width: 85%; overflow: hidden;">
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
    </div>
    <div class="carousel-inner" style="height: 400px;">
        <div class="carousel-item active">
            <img src="@Url.Content("~/images/1.jpg")" class="d-block w-100 rounded" alt="Saç Kesimi">
            <div class="carousel-caption">
                <h1>Profesyonel Saç Kesimi</h1>
                <p>Modern ve klasik tarzlarda uzman kesimler.</p>
            </div>
        </div>
        <div class="carousel-item">
            <img src="@Url.Content("~/images/2.jpg")" class="d-block w-100 rounded" alt="Saç Şekillendirme">
            <div class="carousel-caption">
                <h1>Saç Şekillendirme</h1>
                <p>Profesyonel ürünlerle sağlıklı ve parlak saçlar.</p>
            </div>
        </div>
    </div>
    <button class="carousel-control-prev rounded-circle bg-light p-2" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Önceki</span>
    </button>
    <button class="carousel-control-next rounded-circle bg-light p-2" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Sonraki</span>
    </button>
</div>
<!-- Slider Sonu -->
<!-- Kartlar Başlangıç -->
@if(User.IsInRole("Admin"))
{
<div class="container  my-5">
    <div class="row">
        <!-- Çalışanlar Kartı -->
        <div class="col-md-4 mb-4">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="card-icon">
                        <i class="bi bi-people-fill"></i>
                    </div>
                    <h5 class="card-title">Çalışanlar</h5>
                </div>
                <div class="card-footer">
                    <a asp-controller="Calisan" asp-action="Index" class="btn btn-primary">Daha Fazla</a>
                </div>
            </div>
        </div>
        <!-- İşlemler Kartı -->
        <div class="col-md-4 mb-4">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="card-icon">
                        <i class="bi bi-gear-fill"></i>
                    </div>
                    <h5 class="card-title">İşlemler</h5>
                </div>
                <div class="card-footer">
                    <a asp-controller="Islem" asp-action="Index" class="btn btn-primary">Daha Fazla</a>
                </div>
            </div>
        </div>
        <!-- Randevular Kartı -->
        <div class="col-md-4 mb-4">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="card-icon">
                        <i class="bi bi-calendar-check-fill"></i>
                    </div>
                    <h5 class="card-title">Randevular</h5>
                </div>
                <div class="card-footer">
                    <a asp-controller="Randevu" asp-action="Randevular" class="btn btn-primary">Daha Fazla</a>
                </div>
            </div>
        </div>
    </div>
</div>
}

<!-- Kartlar Sonu -->

<h2>Fotoğraf Yükleyerek Saç Modeli Önerisi Al</h2>
<div class="mt-4">
    <input type="file" id="imageInput" accept="image/*" />
    <button id="uploadButton" class="btn btn-secondary mt-2">Fotoğraf Yükle</button>
    <div id="loading" class="mt-3 text-center" style="display: none;">
        <span class="spinner-border text-primary" role="status"></span>
        <p>Fotoğraf yükleniyor...</p>
    </div>
</div>
<div id="uploadedImage" style="max-width:200px;" class="mt-4"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $("#uploadButton").click(function () {
            const fileInput = $("#imageInput")[0];
            const file = fileInput.files[0];

            if (!file) {
                alert("Lütfen bir fotoğraf seçin!");
                return;
            }

            $("#loading").show();

            const options = ["101", "201", "301", "401", "501", "601", "701", "801", "901", "1001", "1101", "1201", "1301"];
            const randomOption = options[Math.floor(Math.random() * options.length)];

            const data = new FormData();
            data.append("image_target", file);
            data.append("hair_type", randomOption);

            $.ajax({
                url: "https://hairstyle-changer.p.rapidapi.com/huoshan/facebody/hairstyle",
                method: "POST",
                headers: {
                    'x-rapidapi-key': '5abd691723msh5875118067f34e2p12fadcjsn8242f90c015d',
                    'x-rapidapi-host': 'hairstyle-changer.p.rapidapi.com',
                },
                processData: false,
                contentType: false,
                data: data,
                success: function (response) {
                    $("#loading").hide();
                    const base64Image = response.data.image;
                    const imgElement = document.createElement("img");

                    imgElement.src = `data:image/jpeg;base64,${base64Image}`;
                    imgElement.className = "img-thumbnail";
                    imgElement.style.width = "100%";
                    imgElement.style.height = "auto";
                    imgElement.style.marginTop = "20px";

                    $("#uploadedImage").html(imgElement);
                },
                error: function (xhr, status, error) {
                    $("#loading").hide();
                    alert("Bir hata oluştu. Lütfen tekrar deneyin.");
                    console.error("Error:", status, error);
                },
            });
        });
    });
</script>

<style>
    .rounded-slider {
        border-radius: 20px;
    }

    .carousel-control-prev,
    .carousel-control-next {
        width: 40px;
        height: 40px;
    }

    .carousel-item img {
        border-radius: 20px;
        height: 400px;
        object-fit: cover;
    }
</style>